<!doctype html>
<html lang="de" xmlns:th="http://www.thymeleaf.org">
	<head>

		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<!-- CSS -->

			<link rel="stylesheet" th:href="@{/css/main.css}">

	</head>
	<body>

		<nav class="nav">
			<div class="row">
				<div class="column">
					<div class="nav__inner">
						<a class="logo" th:href="@{/}"><span class="track">track</span>17</a>
						<a th:href="@{/sichtung}">Sichtungen</a>
						<a sec:authorize="isAnonymous()" th:href="@{/login}">Login</a>
						<form sec:authorize="isAuthenticated()" th:action="@{/logout}" th:method="POST">
							<b sec:authentication="name" class="color-white"></b>
							<input type="submit" th:value="Logout"></button>
						</form>
						<a sec:authorize="hasRole('ADMIN')" th:href="@{/users}">UserManagement</a>
						<a href="">DE <svg viewbox="0 0 8 8" class="icon"><use xlink:href="/images/open-iconic.svg#globe"></use></svg></a>
					</div>
				</div>
			</div>
		</nav>

		<div class="observation">
			<div class="row">
				<div class="column">
					<h1 class="h1">Aktuelle Sichtungen</h1>
				</div>
			</div>
			<div class="row">
				<div class="column">

					<table th:if="${#lists.size(sichtungen)} > 0">
						<thead>
							<tr>
								<td th:text="#{sichtung.table.number}">Nr.</td>
								<td th:text="#{sichtung.table.date}">Datum</td>
								<td th:text="#{sichtung.table.daytime}">Tageszeit</td>
								<td th:text="#{sichtung.table.location}">Fundort</td>
								<td th:text="#{sichtung.table.name}">Finder</td>
								<td th:text="#{sichtung.table.description}">Beschreibung</td>
								<td th:text="#{sichtung.table.rating}">Rating</td>
								<td th:text="#{sichtung.table.edit}">[edit]</td>
							</tr>
						</thead>
						<tbody>
							<tr th:each="s, iter: ${sichtungen}">
								<td th:text="${iter.index}">1</td>
								<td th:text="${s.date}">01.01.2019</td>
								<td><span th:each="dt: ${s.daytime}" th:text="${dt}" style="margin-right: 6px;"></span></td>
								<td th:text="${s.location}">Unter den Eichen</td>
								<td th:text="${s.finder}">Peter</td>
								<td th:text="${s.description}">Herr Weitz schießt 17 Feuerwerkskörper in die Luft</td>
								<td th:text="${s.rating}">*</td>
								<td><a th:href="@{'/sichtung/' + ${s.id}}"><svg viewbox="0 0 8 8" class="icon observation__icon"><use xlink:href="/images/open-iconic.svg#pencil"></use></svg></a></td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>

			<div class="observation__background">
				<div class="observation__bgbox">
					<h2>Haben Sie eine 17 gesichtet?</h2>
					<p>Dann am besten gleich eine neue Sichtung eintragen!</p>
				</div>
			</div>

			<div sec:authorize="hasRole('MEMBER')" class="row">
				<div class="column">

					<form th:action="@{/sichtung}" th:method="POST" th:object="${sichtungform}">
						<div class="observation__formElem">
							<input class="input observation__input" type="text" id="finder" th:field="*{finder}" th:errorclass="alert-danger" th:placeholder="#{sichtung.form.name}">
							<span class="observation__errormessage" th:if="${#fields.hasErrors('finder')}" th:errors="*{finder}">Finder zu kurz</span>
						</div>

						<div class="observation__formElem">
							<input class="input observation__input" type="text" id="location" th:field="*{location}" th:errorclass="alert-danger" th:placeholder="#{sichtung.form.location}">
							<span class="observation__errormessage" th:if="${#fields.hasErrors('location')}" th:errors="*{location}">Location zu kurz</span>
						</div>

						<div class="observation__formElem">
							<input class="input observation__input" type="date" id="date" th:field="*{date}" th:errorclass="alert-danger">
							<span class="observation__errormessage" th:if="${#fields.hasErrors('date')}" th:errors="*{date}">Date muss ausgefüllt sein</span>
						</div>

						<div class="observation__formElem">
							<div class="form-check" th:each="cb: *{daytimecbs}">
								<input class="control__input" type="checkbox" th:field="*{daytime}" th:value="${cb}" th:errorclass="alert-danger">
								<label class="control__label" th:for="${#ids.prev('daytime')}" th:text="${cb}">morgens</label>
							</div>
							<span class="observation__errormessage" th:if="${#fields.hasErrors('daytime')}" th:errors="*{daytime}">Checkboxen dürfen nicht leer sein</span>
						</div>

						<div class="observation__formElem">
							<label for="rating" th:text="#{sichtung.form.rating}">Rating</label>
							<select class="select" id="rating" th:field="*{rating}" th:errorclass="alert-danger">
								<option th:each="sb: *{ratingsbs}" th:text="${sb}" th:value="${sb}"></option>
							</select>
						</div>

						<div class="observation__formElem">
							<input class="input observation__input" type="text" id="description" th:field="*{description}" th:errorclass="alert-danger" th:placeholder="#{sichtung.form.description}">
							<span th:if="${#fields.hasErrors('description')}" th:errors="*{description}">Darf nicht leer oder länger als 80 Zeichen sein</span>
						</div>

						<input class="button" type="submit" th:value="#{sichtung.form.submit}">

					</form>

				</div>
			</div>

			<div sec:authorize="isAnonymous()" class="row">
				<div class="column">
					<h2 class="h2">Noch kein Mitglied?</h2>
					<p>Sichtungen können nur von Mitgliedern eingetragen werden. Registrieren Sie sich jetzt kostenfrei.</p>
					<a href="" class="button">REGISTRIEREN</a>
				</div>
			</div>
		</div>

	</body>
</html>